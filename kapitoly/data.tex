\chapter{Zpracování dat}

Úvod ke kapitole.... % dopsat!!!!!

\section{Popis obdržených dat}

Všechna data poskytnutá společností jsou uložena v databázi, ke které je byl zhotoven omezený přístup pro účely získání dat pro analýzy shrinku produktů společnosti. Zároveň s možností přístupu jsem obdržela i tabulku, která stručně komentuje všechny tabulky v databázi a sloupce v jednotlivých tabulkách. Celkem se v databázi nachází přes čtyři sta tabulek, z nichž je potřeba vybrat ty, které obsahují relevantními data pro úlohu shrinků.

Z důvodu ochrany dat nelze uvádět přesné názvy tabulek, nicméně pro lepší orientaci v textu, každé použité tabulce přiřadím název, který odpovídá obsaženým datům v tabulce.

\subsubsection{Produkty}

Základní číselník s údaji o produktech, se nachází v tabulce \texttt{produkt} se 27 sloupci. Pro analýzu vzniku shrinků jsem z této tabulky vybrala jako možné významné údaje následující sloupce:
\begin{itemize}
    \item ID produktu a ID prodejní varianty, spolu tvoří primární klíč. 
    \item Krátký a dlouhý název produktu (tento sloupec slouží především k lepší orientaci v datech)
    \item Expirace produktu ve dnech (hodnoty 0, 999 a NULL označují neomezenou expiraci)
    \item Rozměry produktu a jeho hmotnost
    \item ID kategorie produktu v číselné struktuře (pro lepší interpretaci, o jakou kategorii zboží se jedná, je vhodnější použít strukuru 4BOX, kterou lze získat napojením na tabulku \texttt{produkt\_kategorie}.)
\end{itemize}
Tabulka \texttt{produkt\_kategorie} obsahuje převod z číselné struktury, která popisuje kategorii produktu na 4BOX strukturu. 4BOX struktura se skládá ze šesti úrovní. Struktura 4BOX je znázorněná na obrázku \ref*{obr:d:4box}.

\begin{figure}[hbtp!]
    \centering
    \includegraphics[width=\textwidth]{obrazky/4box.pdf}
    \caption{Hierarchie struktury 4BOX používané pro kategorizaci produktů.}
    \label{obr:d:4box}
\end{figure}

V tabulce \ref*{tab:d:4Bzast} jsou uvedeny počty podkategorií pro každou z kategorií L1 a také procentuální zastoupení kategorie L1 v rámci produktového portfolia vybrané společnosti. Zastoupení je odvozeno podle počtu produktů v kategorii.

\begin{table}[]
    \begin{center}
    \caption{Počet podkategorií v L1 kategorii a zastoupení L1 kategorie v rámci produktového portfolia.}
    \label{tab:d:4Bzast}
    \begin{tabular}{p{3cm}  p{1cm} p{1cm} p{1cm} p{1cm} p{1cm}  c}
        & \multicolumn{5}{c}{Počty kategorií} &                      \\
        L1         & L2    & L3   & L4   & L5    & L6    & Zastoupení kategorie \\
        \hline
        nonfood    & 1     & 7    & 27   & 76    & 179   & 76,12\%              \\
        dry   & 3     & 13   & 33   & 147   & 494   & 7,28\%               \\
        HBC        & 1     & 4    & 21   & 59    & 193   & 7,07\%               \\
        fresh & 5     & 11   & 27   & 111   & 469   & 4,27\%               \\
        superfresh & 6     & 10   & 31   & 92    & 271   & 4,04\%               \\
        others     & 4     & 4    & 4    & 5     & 5     & 1,06\%               \\
        tobacco    & 1     & 1    & 1    & 3     & 8     & 0,17\%            
    \end{tabular}
    \end{center}
    \end{table}

Zároveň kategorie L6 je přímo napojená na hodnotu číselné struktury, která je uvedena v číselníku produktů (v tabulce \texttt{produkt}).


Tabulka, která obsahuje 

\subsubsection{Tabulky transakcí}
V tabulce \texttt{transakce} se nachází údaje o všech provedených transakcích, a to jak skladové transakce, tak prodeje na prodejnách. V případě prodejen jsou údaje agregované podle prodejny, konkrétního produktu a dne transakce, tzn. v této tabulce nelze rozlišit konkrétní prodeje na jednotlivých pokladnách, ale pouze souhrn za jeden den. Tabulka obsahuje údaje za posledních dvanáct měsíců.

Tabulka transakcí obsahuje 21 sloupců, jako podstatné pro analýzu jsem vybrala následující sloupce:

\begin{itemize}
    \item ID transakce, jedinečné pro každou transakci
    \item Typ transakce
    \item ID produktu, kterého se transakce týká
    \item ID skladu (včetně prodejen)
    \item Datum transakce (tzv. business datum, pokud samotná transakce proběhne až po půlnoci uvedeného dne, tak se posílá s datem z předchozího dne, neboť do toho dne businessově náleží.)
    \item ID promoce 
    \item Motive\_type z hlediska hledání shrinku produktu se jedná o klíčový sloupec, neboť obsahuje označení jednotlivých typů shrinků.
    \item Množství produktu v dané transakci
    \item Hodnota transakce v nákladové ceně
    \item Hodnota transakce v prodejní ceně včetně DPH -- v případě prodejů se jedná o skutečnou cenu, u zbylých transakcích je uvedena odpovídající cena podle ceníku.
\end{itemize}

Tabulku, která obsahuje údaje o jednotlivých prodejích na prodejnách společnosti, jsem pro účely této práce nazvala \texttt{transakce\_prodeje}. Celkem obsahuje třináct sloupců, z nichž jsem vybrala následující:

\begin{itemize}
    \item ID transakce
    \item ID produktu, kterého se transakce týká
    \item ID prodejny
    \item Datum a čas transakce 
    \item ID promoce
    \item Množství produktu v dané transakci
    \item Hodnota transakce v prodejní ceně bez DPH
    \item Hodnota DPH dané transakce
\end{itemize}

\subsubsection{Tabulky ceníků}


\section{Předzpracování dat}

Množství produktů - 


\section{Statistické zpracování dat}



\subsection{Období jednoho roku}

\input{kapitoly/analyzy_rok.tex}



\subsection{Období jednoho měsíce}

\input{kapitoly/analyzy_mesic.tex}


